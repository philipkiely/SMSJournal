container_commands:
  00_postgres:
    command: "sudo yum install -y  https://download.postgresql.org/pub/repos/yum/10/redhat/rhel-7-x86_64/pgdg-redhat10-10-2.noarch.rpm && sudo sed -i 's/rhel-\$releasever-\$basearch/rhel-latest-x86_64/g' '/etc/yum.repos.d/pgdg-10-redhat.repo' && sudo yum install -y postgresql10-devel"
    leader_only: true
  01_migrate:
    command: "source /opt/python/run/venv/bin/activate && python SMSJournal/manage.py migrate"
    leader_only: true

  02_collectstatic:
    command: "source /opt/python/run/venv/bin/activate && python SMSJournal/manage.py collectstatic --noinput"
    leader_only: true

option_settings:
  - namespace: aws:elasticbeanstalk:container:python:staticfiles
    option_name: /static/
    value: static/
